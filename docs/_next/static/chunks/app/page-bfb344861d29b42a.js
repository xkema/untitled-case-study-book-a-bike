(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{5754:function(e,r,a){Promise.resolve().then(a.bind(a,1836))},1836:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return h}});var l=a(7437),s=a(9039);let d=e=>fetch(e).then(e=>e.json());function t(e){let r=new URLSearchParams(e);r.delete("page","-1"),r.delete("vehicle_type",""),r.delete("bike_id","");let a=r.toString(),l="".concat("https://test-api-a1g.pages.dev/items","/?").concat(a),{data:t,mutate:c,error:i,isLoading:n}=(0,s.ZP)(""===a?null:l,d,{keepPreviousData:!0,revalidateOnFocus:!1});return{data:t,mutate:c,error:i,isLoading:n}}let c=e=>{let r=Math.ceil(e/10),a=[];for(let e=0;e<r;e++)a.push(e+1);return a.map(e=>(0,l.jsx)("option",{value:e,children:e},e))},i=(e,r)=>e.map((e,a)=>e?(0,l.jsxs)("div",{className:"flex items-center justify-center even:bg-gray-100 p-2 hover:bg-gray-50",children:[(0,l.jsx)("span",{className:"flex-1 text-center",children:e.bike_id||"malformed"}),(0,l.jsx)("span",{className:"flex-1 text-center",children:e.vehicle_type||"malformed"}),(0,l.jsx)("span",{className:"flex-1 text-center",children:e.bike_id&&(0,l.jsx)("button",{onClick:a=>r(e.bike_id),children:"details"})})]},e.bike_id||"malformed"):(0,l.jsx)("div",{className:"text-center even:bg-gray-100 p-4 hover:bg-gray-50",children:"malformed data"},"malformed")),n=(e,r,a)=>""!==r&&(0,l.jsx)("div",{className:"flex items-center justify-center fixed h-screen w-screen left-0 top-0 z-50 bg-black/25 backdrop-blur-[1px]",children:(0,l.jsxs)("div",{className:"bg-gray-100 rounded-lg px-8 py-6 border border-black/25 m-4",children:[(0,l.jsx)("ul",{children:(0,l.jsx)("table",{className:"border border-collapse border-black/25",children:(0,l.jsxs)("tbody",{children:[(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border p-2 font-bold border-black/25",children:"bike_id"}),(0,l.jsx)("td",{className:"border p-2 border-black/25",children:e.bike_id||"malformed"})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border p-2 font-bold border-black/25",children:"lat"}),(0,l.jsx)("td",{className:"border p-2 border-black/25",children:e.lat||"malformed"})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border p-2 font-bold border-black/25",children:"lon"}),(0,l.jsx)("td",{className:"border p-2 border-black/25",children:e.lon||"malformed"})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border p-2 font-bold border-black/25",children:"is_reserved"}),(0,l.jsx)("td",{className:"border p-2 border-black/25",children:e.is_reserved||"malformed"})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border p-2 font-bold border-black/25",children:"is_disabled"}),(0,l.jsx)("td",{className:"border p-2 border-black/25",children:e.is_disabled||"malformed"})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border p-2 font-bold border-black/25",children:"vehicle_type"}),(0,l.jsx)("td",{className:"border p-2 border-black/25",children:e.vehicle_type||"malformed"})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border p-2 font-bold border-black/25",children:"total_bookings"}),(0,l.jsx)("td",{className:"border p-2 border-black/25",children:e.total_bookings||"malformed"})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border p-2 font-bold border-black/25",children:"android"}),(0,l.jsx)("td",{className:"border p-2 border-black/25",children:e.android||"malformed"})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"border p-2 font-bold border-black/25",children:"ios"}),(0,l.jsx)("td",{className:"border p-2 border-black/25",children:e.ios||"malformed"})]})]})})}),(0,l.jsx)("div",{className:"text-center mt-4",children:(0,l.jsx)("button",{onClick:e=>a(""),children:"Close"})})]})}),o=e=>e.map(e=>null==e?void 0:e.total_bookings).reduce((e,r)=>(Number.isNaN(parseInt(r))||(e+=parseInt(r)),e),0),b=e=>Array.from(new Set(e.map(e=>null==e?void 0:e.vehicle_type))).sort().map(e=>e?(0,l.jsx)("option",{value:e,children:e.toLowerCase().replace(/\b\w/g,e=>e.toUpperCase())},e):(0,l.jsx)("option",{value:"malformed",disabled:!0,children:"malformed"},"malformed"));var m=a(2265),x=a(7266);function h(){let[e,r]=(0,m.useState)(""),[a,s]=(0,m.useState)(""),[d,h]=(0,m.useState)(1),[p,f]=(0,m.useState)(0),[u]=(0,x.Nr)(e,333),[j,k]=(0,m.useState)(""),{data:v,mutate:N,error:g,isLoading:_}=t("page=".concat(d,"&vehicle_type=").concat(a,"&bike_id=").concat(u)),{data:y,mutate:C,error:w,isLoading:S}=t("bike_id=".concat(j));return(0,m.useEffect)(()=>{_||f(v.ttl)},[v,_]),(0,m.useEffect)(()=>{let e=setTimeout(()=>{p>0&&f(e=>e-1),1===p&&N({...v,ttl:0})},1e3);return()=>clearTimeout(e)},[p,v,N]),(0,l.jsxs)("main",{className:"container mx-auto my-8 flex flex-col gap-8 p-4",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-2 md:flex-row md:gap-4",children:[(0,l.jsx)("input",{type:"text",placeholder:"Search with Bike ID",value:e,onChange:e=>{r(e.target.value),s(""),""===e.target.value?h(1):h(-1)}}),(0,l.jsxs)("select",{value:a,onChange:e=>s(e.target.value),children:[(0,l.jsx)("option",{value:"",children:"choose a vehicle type"}),!_&&Array.isArray(v.data.bikes)&&b(v.data.bikes),!_&&v.data.bike&&null!==v.data.bike&&b([v.data.bike])]}),(0,l.jsxs)("div",{className:"flex flex-col items-end ml-auto",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"font-bold",children:"TTL: "}),(0,l.jsx)("span",{className:"bg-black text-white font-light text-xs leading-6 inline-block min-w-6 font-mono text-center rounded-md",children:p})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"font-bold",children:"Total Bookings: "}),(0,l.jsxs)("span",{children:[!_&&Array.isArray(v.data.bikes)&&o(v.data.bikes),!_&&v.data.bike&&null!==v.data.bike&&o([v.data.bike])]})]})]})]}),(0,l.jsxs)("div",{className:"flex flex-col border border-black/25 rounded-md p-2",children:[!_&&Array.isArray(v.data.bikes)&&i(v.data.bikes,k),!_&&v.data.bike&&null!==v.data.bike&&i([v.data.bike],k)]}),(0,l.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,l.jsx)("button",{disabled:_||d<2,onClick:e=>h(e=>e-1),children:"Prev"}),(0,l.jsxs)("select",{value:d,onChange:e=>h(parseInt(e.target.value)),className:"m-0",children:[(0,l.jsx)("option",{value:"-1",children:"choose page"}),!_&&c(v.total_count)]}),(0,l.jsx)("button",{disabled:_||!v.nextPage,onClick:e=>h(e=>e+1),children:"Next"})]}),(0,l.jsx)("div",{children:!S&&y&&y.data.bike&&n(y.data.bike,j,k)})]})}}},function(e){e.O(0,[814,971,23,744],function(){return e(e.s=5754)}),_N_E=e.O()}]);